@{
    var isAuthenticated = User.Identity?.IsAuthenticated == true;
    var isSuperAdmin = User.IsInRole("SuperAdmin");
    var isAdmin = isSuperAdmin || User.IsInRole("Admin");
    var isTutor = User.IsInRole("Tutor");
    var isStudent = User.IsInRole("Student");
    var isStaff = isAdmin || isTutor;
}

<!-- Noble UI Sidebar -->
<nav class="sidebar">
    <div class="sidebar-header">
        <a href="/" class="sidebar-brand">
            <!-- Full logo when expanded -->
            <img src="img/icon.png" alt="IGB Logo" class="brand-logo-full" style="max-height: 40px; width: auto;">
            <!-- Compact icon when collapsed -->
            <img src="img/icon.png" alt="IGB Icon" class="brand-logo-compact" style="width: 30px; height: 30px;">
        </a>
    </div>
    <div class="sidebar-body">
        <ul class="nav">
            <li class="nav-item nav-category">Main</li>
            
            <!-- Dashboard -->
            <li class="nav-item">
                <a asp-controller="Home" asp-action="Index" class="nav-link">
                    <i class="link-icon fas fa-th"></i>
                    <span class="link-title">Dashboard</span>
                </a>
            </li>

            @* Admin + SuperAdmin *@
            @if (isAuthenticated && isAdmin)
            {
                <!-- Approvals -->
                <li class="nav-item">
                    <a asp-controller="Approvals" asp-action="Index" class="nav-link">
                        <i class="link-icon fas fa-user-check"></i>
                        <span class="link-title">Approvals</span>
                    </a>
                </li>
            }

            @* Admin + SuperAdmin *@
            @if (isAuthenticated && isAdmin)
            {
                <!-- Teachers -->
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#teachersMenu" role="button" aria-expanded="false" aria-controls="teachersMenu">
                        <i class="link-icon fas fa-chalkboard-teacher"></i>
                        <span class="link-title">Teachers</span>
                        <i class="link-arrow fas fa-chevron-down"></i>
                    </a>
                    <div class="collapse" id="teachersMenu">
                        <ul class="nav sub-menu">
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="AdminUsers" asp-action="Tutors">Teachers</a>
                            </li>
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="Feedback" asp-action="TeacherFeedback">Teacher Feedback</a>
                            </li>
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="Reports" asp-action="Progress">Teacher Progress</a>
                            </li>
                        </ul>
                    </div>
                </li>

                <!-- Students -->
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#studentsMenu" role="button" aria-expanded="false" aria-controls="studentsMenu">
                        <i class="link-icon fas fa-user-graduate"></i>
                        <span class="link-title">Students</span>
                        <i class="link-arrow fas fa-chevron-down"></i>
                    </a>
                    <div class="collapse" id="studentsMenu">
                        <ul class="nav sub-menu">
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="AdminUsers" asp-action="Students">Students</a>
                            </li>
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="Feedback" asp-action="StudentFeedback">Student Feedback</a>
                            </li>
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="Reports" asp-action="Progress">Student Progress</a>
                            </li>
                        </ul>
                    </div>
                </li>

                <!-- Guardians -->
                <li class="nav-item">
                    <a class="nav-link" href="/People/Guardians">
                        <i class="link-icon fas fa-user-friends"></i>
                        <span class="link-title">Guardians</span>
                    </a>
                </li>

                <!-- Academics -->
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#academicsMenu" role="button" aria-expanded="false" aria-controls="academicsMenu">
                        <i class="link-icon fas fa-graduation-cap"></i>
                        <span class="link-title">Academics</span>
                        <i class="link-arrow fas fa-chevron-down"></i>
                    </a>
                    <div class="collapse" id="academicsMenu">
                        <ul class="nav sub-menu">
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="Curricula" asp-action="Index">Curricula</a>
                            </li>
                            <li class="nav-item submenu-item">
                                <a class="nav-link" asp-controller="Courses" asp-action="All">Courses</a>
                            </li>
                        </ul>
                    </div>
                </li>
            }

            @* Admin + SuperAdmin *@
            @if (isAuthenticated && isAdmin)
            {
                <!-- Course Bookings (Admin queue) -->
                <li class="nav-item">
                    <a asp-controller="CourseBookings" asp-action="Pending" class="nav-link">
                        <i class="link-icon fas fa-clipboard-check"></i>
                        <span class="link-title">Course Bookings</span>
                    </a>
                </li>
            }

            @* Staff (Tutor/Admin/SuperAdmin) *@
            @if (isAuthenticated && isStaff)
            {
                <!-- Lesson Bookings (Staff queue) -->
                <li class="nav-item">
                    <a asp-controller="LessonBookings" asp-action="Pending" class="nav-link">
                        <i class="link-icon fas fa-calendar-alt"></i>
                        <span class="link-title">Lesson Requests</span>
                    </a>
                </li>
            }

            @* Tutor shortcuts *@
            @if (isAuthenticated && isTutor)
            {
                <li class="nav-item">
                    <a asp-controller="Progress" asp-action="Students" class="nav-link">
                        <i class="link-icon fas fa-user-graduate"></i>
                        <span class="link-title">Students</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a asp-controller="TestReports" asp-action="Index" class="nav-link">
                        <i class="link-icon fas fa-clipboard-list"></i>
                        <span class="link-title">Test Reports</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a asp-controller="Schedule" asp-action="Tutor" class="nav-link">
                        <i class="link-icon fas fa-calendar"></i>
                        <span class="link-title">My Schedule</span>
                    </a>
                </li>
            }

            @* Students *@
            @if (isAuthenticated && isStudent)
            {
                <!-- Browse Courses -->
                <li class="nav-item">
                    <a asp-controller="Courses" asp-action="Browse" class="nav-link">
                        <i class="link-icon fas fa-book-open"></i>
                        <span class="link-title">Browse Courses</span>
                    </a>
                </li>

                <!-- My Course Bookings -->
                <li class="nav-item">
                    <a asp-controller="CourseBookings" asp-action="My" class="nav-link">
                        <i class="link-icon fas fa-receipt"></i>
                        <span class="link-title">My Course Bookings</span>
                    </a>
                </li>

                <!-- Request Lesson -->
                <li class="nav-item">
                    <a asp-controller="LessonBookings" asp-action="Create" class="nav-link">
                        <i class="link-icon fas fa-plus-circle"></i>
                        <span class="link-title">Request Lesson</span>
                    </a>
                </li>

                <!-- My Lessons -->
                <li class="nav-item">
                    <a asp-controller="LessonBookings" asp-action="My" class="nav-link">
                        <i class="link-icon fas fa-user-clock"></i>
                        <span class="link-title">My Lessons</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a asp-controller="Schedule" asp-action="My" class="nav-link">
                        <i class="link-icon fas fa-calendar"></i>
                        <span class="link-title">My Schedule</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a asp-controller="TestReports" asp-action="My" class="nav-link">
                        <i class="link-icon fas fa-clipboard-list"></i>
                        <span class="link-title">My Tests</span>
                    </a>
                </li>
            }

            @* Admin shortcuts *@
            @if (isAuthenticated && isAdmin)
            {
                <li class="nav-item">
                    <a asp-controller="Schedule" asp-action="Overview" class="nav-link">
                        <i class="link-icon fas fa-calendar-check"></i>
                        <span class="link-title">Schedules</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a asp-controller="Reports" asp-action="MissingClasses" class="nav-link">
                        <i class="link-icon fas fa-user-times"></i>
                        <span class="link-title">Missing Classes</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a asp-controller="Reports" asp-action="AttendanceLogs" class="nav-link">
                        <i class="link-icon fas fa-clipboard-check"></i>
                        <span class="link-title">Attendance Logs</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a asp-controller="Reports" asp-action="Progress" class="nav-link">
                        <i class="link-icon fas fa-chart-line"></i>
                        <span class="link-title">Progress Tracker</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a asp-controller="Reports" asp-action="TestAnalytics" class="nav-link">
                        <i class="link-icon fas fa-chart-bar"></i>
                        <span class="link-title">Test Analytics</span>
                    </a>
                </li>
            }

            @* Guardian shortcuts *@
            @if (isAuthenticated && User.IsInRole("Guardian"))
            {
                <li class="nav-item">
                    <a asp-controller="TestReports" asp-action="Ward" class="nav-link">
                        <i class="link-icon fas fa-clipboard-list"></i>
                        <span class="link-title">Ward Tests</span>
                    </a>
                </li>
            }

            <li class="nav-item nav-category">Account</li>
            
            <!-- Change Password -->
            <li class="nav-item">
                <a asp-controller="Account" asp-action="ChangePassword" class="nav-link">
                    <i class="link-icon fas fa-key"></i>
                    <span class="link-title">Change Password</span>
                </a>
            </li>

            <!-- Profile -->
            <li class="nav-item">
                <a asp-controller="Profile" asp-action="Index" class="nav-link">
                    <i class="link-icon fas fa-user"></i>
                    <span class="link-title">Profile</span>
                </a>
            </li>

            <!-- Logout Option -->
            <li class="nav-item">
                <form asp-controller="Account" asp-action="Logout" method="post" class="d-inline w-100">
                    <button type="submit" class="nav-link border-0 bg-transparent w-100 text-start p-0">
                        <i class="link-icon fas fa-sign-out-alt"></i>
                        <span class="link-title">Logout</span>
                    </button>
                </form>
            </li>

        </ul>
    </div>
</nav>

